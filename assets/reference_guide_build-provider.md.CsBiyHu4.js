import{_ as s,c as i,o as a,a4 as e,c0 as t,c1 as n}from"./chunks/framework.BGFi9fUZ.js";const y=JSON.parse('{"title":"Build an hours provider","description":"","frontmatter":{},"headers":[],"relativePath":"reference/guide/build-provider.md","filePath":"reference/guide/build-provider.md","lastUpdated":1703166228000}'),l={name:"reference/guide/build-provider.md"},o=e('<h1 id="build-an-hours-provider" tabindex="-1">Build an hours provider <a class="header-anchor" href="#build-an-hours-provider" aria-label="Permalink to &quot;Build an hours provider&quot;">​</a></h1><p>On OpenCUI, a provider serves as a backend stub to the actual backend implementation of the service. Most providers are external, meaning that the backend is developed and deployed elsewhere as a related but separate effort. However, the PostgreSQL provider is hosted on OpenCUI. It allows you to use PostgreSQL as a data storage and implement API functions using SQL on the OpenCUI platform. OpenCUI will make these functions available to your chatbot and back office via RESTful APIs.</p><p>On OpenCUI, you can declare a frame as basis for table, and add storage annotation to this type so that OpenCUI knows how you want to create table based on this frame. You can use backoffice annotation to control how data are manipulated in backoffice. Furthermore, you can implement functions using SQL, and OpenCUI will turn them into stored procedures and expose them via RESTful automatically. Let&#39;s see how we can build a PostgreSQL provider.</p><p>In the previous guide, you learned how to use a cloned PostgreSQL provider in conjunction with &quot;hour&quot; module to answer questions on business hours. In this guide, we will show you how to develop such a backend for that service using a PostgreSQL provider.</p><h2 id="before-you-start" tabindex="-1">Before you start <a class="header-anchor" href="#before-you-start" aria-label="Permalink to &quot;Before you start&quot;">​</a></h2><ul><li>Log in to <a href="https://build.opencui.io/login" target="_blank" rel="noreferrer">OpenCUI</a>.</li><li><a href="./build-simple-chatbot.html">Build a simple chatbot</a> for how to build a skill with entity slots.</li><li><a href="./reuse-component.html">Reuse a full-stack module</a> to get familiar with the functionality we try to build here.</li></ul><h2 id="create-provider-hoursprovider" tabindex="-1">Create provider: hoursProvider <a class="header-anchor" href="#create-provider-hoursprovider" aria-label="Permalink to &quot;Create provider: hoursProvider&quot;">​</a></h2><p>You can create a provider under any organization, following these steps:</p><ol><li>Within an organization, in the upper right corner of the project area, click <strong>Create</strong> and select <strong>Create provider</strong>.</li><li>In the pop-up window, complete the form for chatbot basic settings and click <strong>Create</strong>. For this provider, you only need to fill in the following fields: <ul><li><strong>Project label</strong>: the unique identifier for the chatbot. Type a short, memorable label for your chatbot. We suggest using a lowercase label. For example, <code>hoursProvider</code>.</li><li><strong>Region</strong>: where you want to deploy this chatbot. Ideally, it should be close to your users.</li></ul></li></ol><p>Keep the <strong>Provider type</strong> to be PostgreSQL, and <strong>Deploy mode</strong> to be OpenCUI-hosted per default.</p><h2 id="import-the-service" tabindex="-1">Import the service <a class="header-anchor" href="#import-the-service" aria-label="Permalink to &quot;Import the service&quot;">​</a></h2><p>To implement a service, you need definitions for all types required by that service. This can be done by importing the module where the service is defined. Here are the steps to follow:</p><ul><li>Enter the <a href="https://build.opencui.io/org/me.quickstart/agent/hours/struct/service_schema" target="_blank" rel="noreferrer">hours module</a> where the service is declared, and <strong>Import</strong> it into the provider you just created.</li></ul><h2 id="create-local-types" tabindex="-1">Create local types <a class="header-anchor" href="#create-local-types" aria-label="Permalink to &quot;Create local types&quot;">​</a></h2><p>Sometimes, to simplify development, you may need intermediate functions. This, along with other reasons, may require defining additional types. However, for the service you want to implement here, this is not necessary, so we can skip this step.</p><h2 id="build-tables" tabindex="-1">Build tables <a class="header-anchor" href="#build-tables" aria-label="Permalink to &quot;Build tables&quot;">​</a></h2><p>With the PostgreSQL provider, you can define a table schema by adding storage annotations to a data type. Generally, a frame will map to a table, with its slots mapping to the corresponding table columns. The frame label specifies the name of the table, while the slot label specifies the name of the column in the table. The SQL data type specifies the type of data that the column can hold. These annotations help OpenCUI automatically create a mapping between the database and Kotlin code. OpenCUI will create tables based on the type definition and storage annotations in a separate database for your organization. Additionally, you should add backoffice annotations to define how the corresponding column should be displayed and manipulated in the backoffice.</p><h3 id="build-frame-hours" tabindex="-1">Build frame: Hours <a class="header-anchor" href="#build-frame-hours" aria-label="Permalink to &quot;Build frame: Hours&quot;">​</a></h3><p>Since most businesses have consistent operating hours from week to week, it is enough to record whether the business is open on each day of the week, along with its respective opening and closing times. These, along with hours for special dates such as holidays, should be stored in a table.</p><p>To effectively encode business hours, the following columns are necessary:</p><ul><li><code>dayOfWeek</code>: The day of the week.</li><li><code>ifOpen</code>: Whether the business is open on that day.</li><li><code>openingTime</code>: The time when the business opens on that day. Required when <strong>ifOpen</strong> is true.</li><li><code>closingTime</code>: The time when the business closes on that day. Required when <strong>ifOpen</strong> is true.</li><li><code>specialDate</code>: The date that deviates from the standard business hours. Required when setting a special date, like a holiday or other special event.</li></ul><p>To define this table, you will build an <code>Hours</code> frame with slots corresponding to the above columns.</p><h4 id="schema-layer-declare-a-frame" tabindex="-1">Schema layer: declare a frame <a class="header-anchor" href="#schema-layer-declare-a-frame" aria-label="Permalink to &quot;Schema layer: declare a frame&quot;">​</a></h4><p>To create a table for storing business hours data, you will first create an <code>Hours</code> frame and enable storage. Then, you will add corresponding slots to the frame, where the slot type specifies the column type.</p><h5 id="create-the-frame" tabindex="-1">Create the frame <a class="header-anchor" href="#create-the-frame" aria-label="Permalink to &quot;Create the frame&quot;">​</a></h5><p>Inside the <strong>target provider</strong> with the hours module already imported and <strong>Types</strong> page.</p><ol><li><p>Click <strong>Create</strong> button on the right side, and select <strong>Create frame</strong>.</p></li><li><p>Enter <code>Hours</code> as a label for the frame type and press enter.</p></li><li><p>Inside the <code>Hours</code> frame, turn on <strong>Storage enabled</strong>.</p><p><img src="'+t+`" alt="enable storage"></p></li></ol><h5 id="add-slots" tabindex="-1">Add slots <a class="header-anchor" href="#add-slots" aria-label="Permalink to &quot;Add slots&quot;">​</a></h5><p>Inside the <code>Hours</code> frame and <strong>Schema</strong> tab.</p><ul><li>In the <strong>Slots</strong> section, add the following slots: <ul><li>Type <strong>java.time.DayOfWeek</strong> with label <code>dayOfWeek</code>.</li><li>Type <strong>kotlin.Boolean</strong> with label <code>ifOpen</code>.</li><li>Type <strong>java.time.LocalTime</strong> with label <code>openingTime</code>.</li><li>Type <strong>java.time.LocalTime</strong> with label <code>closingTime</code>.</li><li>Type <strong>java.time.LocalDate</strong> with label <code>specialDate</code>.</li></ul></li></ul><h4 id="annotate-type-hours" tabindex="-1">Annotate type: Hours <a class="header-anchor" href="#annotate-type-hours" aria-label="Permalink to &quot;Annotate type: Hours&quot;">​</a></h4><p>Based on the <a href="#build-frame-hours">columns description</a> provided, it&#39;s important to note that the <code>dayOfWeek</code> and <code>ifOpen</code> columns should not be left empty. Additionally, since there are only seven days of the week, you need to apply constraints to ensure that the <code>dayOfWeek</code> column accepts valid input.</p><p>Backend annotations can optimize frames with storage enabled. To ensure completeness of data, turn off <strong>Allow null</strong> for columns that should not be empty. In addition, you can use the <strong>Dropdown</strong> input type to restrict columns to only accept specific options.</p><h5 id="add-slot-level-annotations-to-dayofweek" tabindex="-1">Add slot level annotations to dayOfWeek <a class="header-anchor" href="#add-slot-level-annotations-to-dayofweek" aria-label="Permalink to &quot;Add slot level annotations to dayOfWeek&quot;">​</a></h5><p>Inside the <code>Hours/dayOfWeek</code> slot and <strong>Annotation</strong> tab.</p><ol><li>Turn off <strong>Allow null</strong>.</li><li>Switch the <strong>Input type</strong> to <strong>Dropdown</strong>, and add the following JSON array:<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;MONDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Monday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TUESDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Tuesday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;WEDNESDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Wedesday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;THURSDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Thusday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;FRIDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Friday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SATURDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Saturday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;SUNDAY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Sunday&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div></li></ol><p>When it&#39;s done, the <code>dayOfWeek</code> slot should look like this:</p><p><img src="`+n+`" alt="dayOfWeek annotations"></p><h5 id="add-slot-level-annotation-to-ifopen" tabindex="-1">Add slot level annotation to ifOpen <a class="header-anchor" href="#add-slot-level-annotation-to-ifopen" aria-label="Permalink to &quot;Add slot level annotation to ifOpen&quot;">​</a></h5><p>Inside the <code>Hours/ifOpen</code> slot and <strong>Annotation</strong> tab.</p><ul><li>Turn off <strong>Allow null</strong>.</li></ul><h2 id="implement-the-service" tabindex="-1">Implement the service <a class="header-anchor" href="#implement-the-service" aria-label="Permalink to &quot;Implement the service&quot;">​</a></h2><p>Finally, after the tables are ready, you can provide implementation for each function defined in the service. You can do this on the OpenCUI platform using <a href="https://www.postgresql.org/docs/current/plpgsql.html" target="_blank" rel="noreferrer">PL/pgSQL</a> or native Kotlin code.</p><p>Inside the <strong>target provider</strong> with the hours module already imported and <strong>Service</strong> page.</p><ul><li><p>In the <strong>Functions</strong> section, click into <code>getHoursDay</code> function.</p><ol><li>Make sure the implementation is <strong>Provider dependent</strong>.</li><li>Add <strong>Implementation</strong> and <strong>Save</strong>. This function will return the business hour for the specific date, so the implementation can be like this:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BEGIN</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  RETURN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> QUERY</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  SELECT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dayOfWeek&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ifOpen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;openingTime&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;closingTime&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  WHERE</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT DISTINCT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ifOpen&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;specialDate&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> NULL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dayOfWeek&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> EXTRACT(ISODOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">text</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  OR</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">     (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CASE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">SELECT DISTINCT</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ifOpen&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> FROM</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Hours&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> WHERE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;specialDate&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">IS NOT NULL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;specialDate&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">      END</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">END</span></span></code></pre></div></li></ol></li><li><p>In the <strong>Functions</strong> section, click into <code>getHoursWeek</code> function.</p><ol><li>Select <strong>Kotlin</strong> as the <strong>Implementation</strong>.</li><li>Add <strong>Implementation</strong> and <strong>Save</strong>. This function will get the business hours for the week, so the implementation can be like this:<div class="language-kotlin vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">kotlin</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">val</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> currentDate </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> java.time.ZonedDateTime.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toLocalDate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hoursList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> mutableListOf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BusinessHours</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">..</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">){</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">   var</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> date </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> currentDate.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">plusDays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toLong</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   hoursList.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">getHoursDay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(date))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> hoursList</span></span></code></pre></div></li></ol></li></ul><p>After you have finished building a PostgREST provide, you can <a href="./opencui-flow.html#create-a-pull-request">create a pull request</a>, <a href="./opencui-flow.html#review-and-merge-pull-request">review changes and merge them into the master</a>. In the next step, you can use backoffice to add data and use <a href="./../providers/postgrest.html#function-console">function console</a> to test the functions you just implemented.</p>`,46),h=[o];function r(p,d,k,u,c,E){return a(),i("div",null,h)}const F=s(l,[["render",r]]);export{y as __pageData,F as default};
